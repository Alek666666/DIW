<!DOCTYPE html>
<!-- saved from url=(0077)https://ncode.amorce.org/ressources/Pool/MS_FULL_STACK/PHP/PHP_Fonctions.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title></title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="./PHP_Fonctions_files/font-awesome.min.css">
        <link rel="stylesheet" href="./PHP_Fonctions_files/bootstrap.min.css">
        <link rel="stylesheet" href="./PHP_Fonctions_files/darcula.css">
        <!-- <link rel="stylesheet" href="/css/highlight/line-number.css"> -->
        <link rel="stylesheet" href="./PHP_Fonctions_files/github-markdown.css">
        <!-- <link rel="stylesheet" href="/css/markdown_foad.css"> -->
        <link rel="stylesheet" href="./PHP_Fonctions_files/menu-markdown.css">
        <!-- <script src="/js/highlightjs-line-numbers.min.js"></script> -->
        <script src="./PHP_Fonctions_files/jquery-3.4.1.min.js"></script>
        <script src="./PHP_Fonctions_files/popper.min.js"></script>
        <script src="./PHP_Fonctions_files/bootstrap.min.js"></script>
        <script src="./PHP_Fonctions_files/highlight.js"></script>
        </head><body><div class="container"><div class="markdown-body"><h1 id="1">PHP - Les fonctions</h1>
<p><br>
<br></p>
<h2 id="3">Définition</h2>
<p>Une fonction est une partie de code PHP qui peut remplir n'importe quelle tâche. Dans ce code, peut figurer toute instruction PHP valide.
Une fonction est destinée à effectuer une tâche spécifique prédéfinie. </p>
<p>On rencontre 2 types de fonctions :</p>
<ul>
<li>Les fonctions <strong>natives</strong> = celles proposées par défaut par le langage; en PHP il en existe <a href="http://php.net/manual/fr/indexes.functions.php" target="_blank">des centaines</a> </li>
<li>Les fonctions <strong>utilisateurs</strong> = celles que le développeur écrit, et qui peuvent bien entendu intégrer des fonctions natives. </li>
</ul>
<p>Dans l'exemple ci-dessous, nous utilisons la fonction <code>ucfirst()</code>. Cette fonction permettra de passer le premier caractère de la chaîne en majuscule :</p>
<pre><code class="hljs perl">$texte = <span class="hljs-keyword">ucfirst</span>(<span class="hljs-string">"Bonjour le monde"</span>);</code></pre>
<p>La variable <code>$texte</code> contiendra alors la valeur : <em>Bonjour le monde</em>. Le premier caractère est passé en majuscule.
L'utilisation des fonctions présente de très nombreux avantage parmi lesquels se trouve la non-répétition d'une séquence ce code car cette opération est souvent la cause d'importants dysfonctionnements.</p>
<p>Ces fonctions permettent également une meilleure lisibilité du code source, un gain de productivité ainsi qu'une maintenance facilitée.</p>
<h3 id="11">Définir une fonction</h3>
<p>Pour déclarer (= définir) une fonction, on utilisera le mot clé <code>function</code> suivi du nom de la fonction (à vous de lui donner un nom) et enfin de parenthèses (obligatoires, mêmes vides) pour accueillir d'éventuels paramètres.
Exemple d'une fonction simple :</p>
<pre><code class="language-php hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bonjour</span><span class="hljs-params">()</span> 
</span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Bonjour"</span>;
}   </code></pre>
<p>On appellera donc la fonction de la manière suivante : </p>
<pre><code class="language-php hljs">
bonjour();
</code></pre>
<p>Cette fonction affichera Bonjour. On pourrait également ajouter un nom ou prénom comme ceci :</p>
<pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bonjour</span><span class="hljs-params">($prenom)</span> 
</span>{
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Bonjour "</span>.$prenom;
}</code></pre>
<p>On appellera la fonction avec l'instruction suivante :</p>
<pre><code class="hljs cpp">&lt;?<span class="hljs-function">php   
<span class="hljs-title">bonjour</span><span class="hljs-params">(<span class="hljs-string">"Dave"</span>)</span></span>;</code></pre>
<p>Cette fonction affichera <em>Bonjour Dave</em>. On peut également utiliser plusieurs paramètres entre les parenthèses. Exemple :</p>
<pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bonjour</span><span class="hljs-params">($prenom, $nom)</span> 
</span>{
   <span class="hljs-keyword">echo</span> <span class="hljs-string">"Bonjour "</span>.$prenom.<span class="hljs-string">" "</span>.$nom;
}</code></pre>
<p>On appellera la fonction avec l'instruction suivante : </p>
<pre><code class="hljs cpp">&lt;?<span class="hljs-function">php
<span class="hljs-title">bonjour</span><span class="hljs-params">(<span class="hljs-string">"Dave"</span>,<span class="hljs-string">"LOPER"</span>)</span></span>;</code></pre>
<p>Cette fonction affichera donc <em>Bonjour Dave LOPER</em>.
En pratique, les valeurs indiquées entre les parenthèses sont les arguments de la fonction.</p>
<h3 id="25">La portée d'une variable</h3>
<p>Une variable définie au sein d'une fonction n'est pas accessible en dehors de celle-ci. De même une variable définie en dehors d'une fonction n'est pas accessible par celle-ci. On appelle cela la portée d'une variable. </p>
<p>Pour donner accès à une variable le PHP met à votre disposition deux déclarations : <code>global</code> et <code>static</code> </p>
<pre><code class="hljs php">$a = $b = <span class="hljs-number">2</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">somme</span><span class="hljs-params">()</span> </span>{ 
   $c = $a + $b; 
   <span class="hljs-keyword">echo</span> <span class="hljs-string">"$c"</span>; 
} 

somme(); </code></pre>
<p>Dans cet exemple, la valeur affichée sera 0 car les deux variables <code>$a</code> et <code>$b</code> ne sont pas connues à l'intérieur de la fonction <code>somme()</code>. </p>
<p>Pour les utiliser dans la fonction, il faut les déclarer comme variables globales </p>
<pre><code class="hljs php">$a = $b = <span class="hljs-number">2</span>; 

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">somme</span><span class="hljs-params">()</span> </span>{ 
  <span class="hljs-keyword">global</span> $a, $b; 
  $b = $a + $b; 
} 

somme(); 

<span class="hljs-keyword">echo</span> $b.<span class="hljs-string">"&lt;br&gt;"</span>;  </code></pre>
<p>L'instruction <code>static</code> sert dans le corps de la fonction à conserver la valeur d'une variable </p>
<pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Test</span><span class="hljs-params">()</span> </span>{ 
   $a=<span class="hljs-number">0</span>; 
   <span class="hljs-keyword">echo</span> $a.<span class="hljs-string">"&lt;br&gt;"</span>; 
   $a++; 
} 

<span class="hljs-comment">// Appel de la fonction (2 fois)</span>
Test(); 
Test(); </code></pre>
<p>Dans cet exemple nous faisons appel à une fonction qui initialise la variable <code>$a</code> à 0, puis incrémente celle-ci après un affichage. Le problème est qu'à chaque appel de la fonction celle-ci repasse à 0, car la variable n'est pas stockée et s'initialise à chaque rappel de la fonction </p>
<pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Test1</span> <span class="hljs-params">()</span> 
</span>{ 
   <span class="hljs-keyword">static</span> $a=<span class="hljs-number">0</span>; 
   <span class="hljs-keyword">echo</span> <span class="hljs-string">"$a&lt;br /&gt;"</span>; 
   $a++;
} 

<span class="hljs-comment">// Appel de la fonction (3 fois)</span>
Test1(); 
Test1(); 
Test1(); </code></pre>
<p>Cette fois la variable reste stockée et affiche 0 puis 1,2,3... </p>
<p>--&gt; Voir ici la <a href="http://php.net/manual/fr/language.variables.scope.php#language.variables.scope.static" target="_blank">documentation complète sur la portée des variables</a></p>
<h3 id="38">Les librairies de fonctions</h3>
<p>Une librairie de fonctions est un ensemble de fonctions regroupées dans un seul fichier.
En fait, les fonctions que nous créons ne sont disponibles que dans le ficher dans lequel elles se trouvent. Ainsi, pour les utiliser dans un autre programme, il faudrait les recopier.
Mais, il existe bien sur un moyen de rendre les fonctions disponibles dans tous nos programmes.
Il suffit pour cela, de regrouper vos fonctions dans un fichier externe et de référencer ce fichier dans votre script principal et ainsi rendre disponible toutes les fonctions pour ce programme.
En pratique, il faut créer un fichier contenant toutes les fonctions. </p>
<p>Concrètement :</p>
<pre><code class="language-php hljs"><span class="hljs-meta">&lt;?php</span>   
    <span class="hljs-function"><span class="hljs-keyword">function</span> 1...
    ...
    <span class="hljs-title">function</span> 2...
    ...
?&gt;</span></code></pre>
<p>Enregistrer le fichier sous un nom quelconque que vous choisirez.
Par exemple : <code>mesfonctions.php</code></p>
<p>Vous pourrez ajouter dans ce fichier autant de fonctions que vous aurez besoin pour vos applications. </p>
<p>Ensuite, nous ajouterons l'instruction <code>require</code> ou (<code>inlude</code>) dans chaque programme où nous aurons besoin des fonctions :</p>
<pre><code class="language-php hljs"><span class="hljs-meta">&lt;?php</span>
    <span class="hljs-keyword">require</span>(<span class="hljs-string">'mesfonctions.php'</span>);

    <span class="hljs-comment">//...suite de l'application...</span>
<span class="hljs-meta">?&gt;</span></code></pre>
<h2 id="46">Les grands groupes de fonctions PHP</h2>
<h3 id="47">Les fonctions arithmétiques</h3>
<p>Le langage PHP offre un jeu de fonctions mathématiques assez complet qui couvre largement les besoins que l'on peut avoir pour réaliser une application.
Composition :</p>
<ul>
<li>opérateurs mathématiques (addition, soustraction, multiplication, division, puissance...)</li>
<li>arrondis, valeur absolue, minimum, maximum, ...</li>
<li>cosinus, sinus, tangente, logarithmes...</li>
<li>génération de nombres aléatoires</li>
<li>conversions (binaire, décimal, hexadécimal…)</li>
<li>formatage de nombres (en chaîne de caractères, ...)</li>
</ul>
<h3 id="50">La gestion des chaînes de caractères</h3>
<p>PHP fournit un ensemble complet de fonctions pour gérer les chaînes de caractères :  </p>
<ul>
<li>comparer des chaînes de caractères</li>
<li>définir la longueur d'une chaîne de caractères</li>
<li>découper une chaîne, extraire des parties</li>
<li>crypter des chaînes/données</li>
<li>remplacer des parties de chaînes</li>
<li>rechercher des composants d'une chaîne de caractères</li>
<li>convertir des caractères spécifiques en code HTML</li>
</ul>
<h3 id="53">La gestion des fichiers et répertoires</h3>
<p>Les fonctions de gestion de fichiers et de répertoires fournies par PHP vous permettront :</p>
<ul>
<li>de créer, modifier, supprimer, renommer et déplacer des fichiers de tout type (texte, csv, images, PDF…)</li>
<li>de créer, modifier (nom), supprimer, renommer et déplacer des répertoires</li>
<li>de lire, ajouter, modifier et supprimer du contenu d’un fichier</li>
<li>de lire et modifier les informations de métadonnées (dates de création/modification/accès, nom, type, poids, droits d’exécution…) d’un fichier ou d’un répertoire </li>
</ul>
<h3 id="56">Les fonctions de génération d'images dynamiques</h3>
<p>Une librairie de fonctions de création et de manipulation d'images est fournie avec PHP. Cette librairie se nomme GD (pour <em>Gif Draw</em>).   </p>
<p>GD permet de nombreuses possibilités :</p>
<ul>
<li>générer dynamiquement des images (formes géométriques, miniatures, graphiques…)</li>
<li>gestion des couleurs dans une image</li>
<li>transmettre des informations sur une image (largeur x hauteur),</li>
<li>découper et faire pivoter une image (rotation selon un angle précis) </li>
<li>incrustation de texte, superposition/fusion d'images (par exemple, ajouter un logo dans une image pour montrer qu'elle provient d'un site)</li>
<li>manipuler les différents formats d’images (gif, png, jpeg, tiff, raw…)    </li>
</ul>
<p><a href="https://openclassrooms.com/courses/918836-concevez-votre-site-web-avec-php-et-mysql/916429-creer-des-images-en-php" target="_blank">Les bases de GD et quelques exemples</a></p>
<h3 id="61">Les fonctions spécifiques à Internet</h3>
<p>Le PHP, conçu pour Internet, propose bien sûr un groupe de fonctions spécifiques à celui-ci :</p>
<ul>
<li>fonctions de traitement d'URLs</li>
<li>fonctions de lecture d'une page HTML (avec la librairie <em>CURL</em> notamment)</li>
<li>la protection d'accès à une page web : sessions, cryptage de mots de passe que nous aborderons plus tard dans le programme</li>
<li>envoi de mails (séquence complète)</li>
<li>fonctions de gestion de cookies</li>
</ul>
<h2 id="64">Quelques fonctions utiles</h2>
<table>
<thead>
<tr>
<th>Fonction</th>
<th>Description</th>
<th>Code PHP</th>
<th>Résultat</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>substr()</code></td>
<td>Retourne un segment de chaîne</td>
<td><code>$s = substr("QOTSA", 2, 3);</code></td>
<td><code>TSA</code></td>
</tr>
<tr>
<td><code>addslashes()</code></td>
<td>Ajoute des anti-slashes devant les caractères spéciaux</td>
<td><code>$s = addslashes("L'a");</code></td>
<td><em>L\'a</em></td>
</tr>
<tr>
<td><code>stripslashes()</code></td>
<td>Retire les antislashes devant les caractères spéciaux</td>
<td><code>$s = stripslashes("L\'a");</code></td>
<td><em>L'a</em></td>
</tr>
<tr>
<td><code>ceil()</code></td>
<td>Retourne le nombre entier supé-rieur ici (12,1)</td>
<td><code>$s = ceil("12.1");</code></td>
<td>13</td>
</tr>
<tr>
<td><code>htmlentities()</code></td>
<td>Remplace les caractères par leur équivalent HTML (si ils existent).</td>
<td><code>$s = htmlentities("&lt;");</code></td>
<td><em>\&lt;</em></td>
</tr>
<tr>
<td><code>strstr()</code></td>
<td>Recherche le premier caractère 'p' dans la chaîne et affiche le reste de la chaîne y compris le 'p'</td>
<td><code>$s = strstr ("webmas-ter@php.cdsi.fr.st", "p");</code></td>
<td><em>php.cdsi.fr.st</em></td>
</tr>
<tr>
<td><code>strlen()</code></td>
<td>Retourne la longueur de la chaîne</td>
<td><code>$s = strlen("lachainedecaracteres");</code></td>
<td><em>20</em></td>
</tr>
<tr>
<td><code>strtolower()</code></td>
<td>Passe tout les caractères en minuscules</td>
<td><code>$s = strtolower("LA CHAINE dE caRActERes");</code></td>
<td><em>la chaine de caracteres</em></td>
</tr>
<tr>
<td><code>strtoupper()</code></td>
<td>Passe tout les caractères en majuscules</td>
<td><code>$s = strtoupper("LA CHAINE dE caRActERes")</code></td>
<td><em>LA CHAINE DE CARACTERES</em></td>
</tr>
<tr>
<td><code>str_replace()</code></td>
<td>Remplace un caractère par un autre dans une chaîne (tient compte de la casse)</td>
<td><code>$s = str_replace("a","o","Lalala");</code></td>
<td><em>Lololo</em></td>
</tr>
<tr>
<td><code>trim()</code></td>
<td>Efface les espaces dits blancs (espaces, sauts et retours de lignes au début et à la fin d'une chaîne</td>
<td><code>$s = trim("    Bonjour le monde     ");</code></td>
<td><em>Bonjour le monde</em></td>
</tr>
<tr>
<td><code>ucfirst()</code></td>
<td>Met la première lettre d'une chaîne en majuscule</td>
<td><code>$s = ucfirst("bonjour le monde");</code></td>
<td><em>Bonjour le monde</em></td>
</tr>
<tr>
<td><code>ucwords()</code></td>
<td>Met la première lettre de chaque mot d'une chaîne en majuscule</td>
<td><code>$s = ucwords("bonjour le monde");</code></td>
<td><em>Bonjour Le Monde</em></td>
</tr>
<tr>
<td><code>strpos()</code></td>
<td>Recherche la position du premier caractère trouvé. Retourne le nombre de caractères placés avant lui (ici 4).</td>
<td><code>$s = strpos("abcdef","e");</code></td>
<td>4</td>
</tr>
<tr>
<td><code>join()</code></td>
<td>Rassemble les éléments d'un tableau en une chaîne</td>
<td><code>$arr = array("john", "paul", "georges", "ringo"); echo join(",",$arr);</code></td>
<td>"john,paul,georges,ringo"</td>
</tr>
<tr>
<td><code>preg_match()</code></td>
<td>Recherche si une chaîne de caractères est contenue dans une autre (ex. recherche si <em>ABCDE</em> contient <em>BCD</em>). Peut rechercher via des expressions régulières</td>
<td><code>preg_match ("BCD","ABCDEF")</code></td>
<td>Renvoie 1 (TRUE) si touvé, 0 (FALSE) sinon</td>
</tr>
</tbody>
</table>
<h2 id="66">Exercices</h2>
<h4 id="67">Ecrivez une fonction qui permette de générer un lien.</h4>
<p>La fonction doit prendre deux paramètres, le lien et le titre</p>
<pre><code class="language-php hljs"> lien(<span class="hljs-string">"https://www.reddit.com/"</span>, <span class="hljs-string">"Reddit Hug"</span>);</code></pre>
<p>Appelée de cette façon, la fonction doit générer </p>
<pre><code class="language-html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://www.reddit.com/"</span>&gt;</span>Reddit Hug<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>
<h4 id="72">Ecrivez une fonction qui calcul la somme des valeurs d'un tableau</h4>
<p>La fonction doit prendre un paramètre de type tableau</p>
<pre><code class="language-php hljs"> $tab = <span class="hljs-keyword">array</span>(<span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>);
 $resultat = somme($tab);</code></pre>
<p><code>$resultat</code> doit contenir <code>17</code> </p>
<h4 id="76">Créer une fonction qui vérifie le niveau de complexité d'un mot de passe</h4>
<p>Elle doit prendra un paramètre de type chaîne de caractères.
Elle retournera une valeur booléenne qui vaut true si le paramètre (le mot de passe) respecte les règles suivantes :</p>
<ul>
<li>Faire au moins 8 caractères de long</li>
<li>Avoir au moins 1 chiffre</li>
<li>Avoir au moins une majuscule et une minuscule</li>
</ul>
<pre><code class="language-php hljs">$resultat = complex_password(<span class="hljs-string">"TopSecret42"</span>);</code></pre>
<p><code>$resultat</code> doit contenir <code>true</code>.</p>
<blockquote>
<p>Aidez-vous des expressions régulières !</p>
</blockquote>
<p><br>
<br>
<br></p></div><div class="menu-markdown"><img src="./PHP_Fonctions_files/menu.png"><div data-id="1" class="titre">PHP - Les fonctions</div><div data-id="3">Définition</div><div data-id="11">&nbsp;&nbsp;&nbsp;&nbsp;Définir une fonction</div><div data-id="25">&nbsp;&nbsp;&nbsp;&nbsp;La portée d'une variable</div><div data-id="38">&nbsp;&nbsp;&nbsp;&nbsp;Les librairies de fonctions</div><div data-id="46">Les grands groupes de fonctions PHP</div><div data-id="47">&nbsp;&nbsp;&nbsp;&nbsp;Les fonctions arithmétiques</div><div data-id="50">&nbsp;&nbsp;&nbsp;&nbsp;La gestion des chaînes de caractères</div><div data-id="53">&nbsp;&nbsp;&nbsp;&nbsp;La gestion des fichiers et répertoires</div><div data-id="56">&nbsp;&nbsp;&nbsp;&nbsp;Les fonctions de génération d'images dynamiques</div><div data-id="61">&nbsp;&nbsp;&nbsp;&nbsp;Les fonctions spécifiques à Internet</div><div data-id="64">Quelques fonctions utiles</div><div data-id="66">Exercices</div><div data-id="67">&nbsp;&nbsp;&nbsp;&nbsp;Ecrivez une fonction qui permette de générer un lien.</div><div data-id="72">&nbsp;&nbsp;&nbsp;&nbsp;Ecrivez une fonction qui calcul la somme des valeurs d'un tableau</div><div data-id="76">&nbsp;&nbsp;&nbsp;&nbsp;Créer une fonction qui vérifie le niveau de complexité d'un mot de passe</div></div></div><script>hljs.initHighlightingOnLoad();//hljs.initLineNumbersOnLoad();</script><script src="./PHP_Fonctions_files/menu-markdown.js"></script><div></div></body></html>